<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RaktSewa - Blood Bank Management System</title>
    <meta
      name="description"
      content="RaktSewa Blood Bank Management System - Connecting donors, hospitals, and patients to save lives through efficient blood donation management."
    />
    <meta
      name="keywords"
      content="blood donation, blood bank, healthcare, emergency blood, donor management"
    />
    <meta name="author" content="RaktSewa Team" />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/x-icon"
      href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2IDMuMkMxMC4zIDMuMiA1LjcgNy44IDUuNyAxMy41QzUuNyAxOS4yIDEwLjMgMjMuOCAxNiAyMy44QzIxLjcgMjMuOCAyNi4zIDE5LjIgMjYuMyAxMy41QzI2LjMgNy44IDIxLjcgMy4yIDE2IDMuMloiIGZpbGw9IiNkYzM1NDUiLz4KPHBhdGggZD0iTTE2IDhWMTlIMTJWMTZIOVYxMkgxMlY4SDE2WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css" />

    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />

    <!-- SweetAlert2 for beautiful alerts -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"
    />

    <!-- Open Graph Meta Tags -->
    <meta
      property="og:title"
      content="RaktSewa - Blood Bank Management System"
    />
    <meta
      property="og:description"
      content="Connecting donors, hospitals, and patients to save lives through efficient blood donation management."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://localhost/RaktSewa/" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="RaktSewa - Blood Bank Management System"
    />
    <meta
      name="twitter:description"
      content="Connecting donors, hospitals, and patients to save lives through efficient blood donation management."
    />
  </head>
  <body>
    <!-- Header Navigation -->
    <header class="header">
      <nav class="navbar container">
        <a href="index.html" class="navbar-brand">
          <div class="logo-icon">
            <i class="fas fa-tint"></i>
          </div>
          RaktSewa
        </a>

        <ul class="navbar-nav" id="navbarNav">
          <li><a href="#home" class="nav-link active">Home</a></li>
          <li><a href="#about" class="nav-link">About</a></li>
          <li><a href="#services" class="nav-link">Services</a></li>
          <li><a href="#campaigns" class="nav-link">Campaigns</a></li>
          <li><a href="#contact" class="nav-link">Contact</a></li>
          <li>
            <a href="login.html" class="btn btn-outline-primary">Login</a>
          </li>
          <li><a href="register.html" class="btn btn-primary">Register</a></li>
        </ul>

        <!-- Mobile menu toggle -->
        <button
          class="mobile-menu-toggle"
          id="mobileMenuToggle"
          style="display: none"
        >
          <i class="fas fa-bars"></i>
        </button>
      </nav>
    </header>

    <!-- Main Content -->
    <main>
      <!-- Hero Section -->
      <section id="home" class="hero">
        <div class="container">
          <div class="hero-content">
            <h1 class="hero-title fade-in">
              Every Drop Counts, Every Life Matters
            </h1>
            <p class="hero-subtitle slide-in-up">
              Join RaktSewa - the most trusted blood bank management platform
              connecting donors, hospitals, and patients to save lives together.
            </p>

            <div class="hero-buttons">
              <a href="register.html" class="btn btn-primary btn-lg">
                <i class="fas fa-user-plus"></i> Become a Donor
              </a>
              <a href="#emergency" class="btn btn-outline-primary btn-lg">
                <i class="fas fa-exclamation-triangle"></i> Emergency Blood
              </a>
            </div>
          </div>
        </div>
      </section>

      <!-- Quick Actions for Different User Types -->
      <section
        class="quick-actions"
        style="padding: 4rem 0; background-color: var(--accent-white)"
      >
        <div class="container">
          <h2 class="text-center mb-4">Quick Access Portals</h2>
          <div class="row">
            <div class="col-4">
              <div class="card text-center">
                <div class="card-body">
                  <div class="stat-icon">
                    <i class="fas fa-users-cog"></i>
                  </div>
                  <h4 class="card-title">Admin Portal</h4>
                  <p class="card-text">
                    Manage hospitals, campaigns, and overall system
                    administration.
                  </p>
                  <a href="login.html?role=admin" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Admin Login
                  </a>
                </div>
              </div>
            </div>
            <div class="col-4">
              <div class="card text-center">
                <div class="card-body">
                  <div class="stat-icon">
                    <i class="fas fa-hospital"></i>
                  </div>
                  <h4 class="card-title">Hospital Portal</h4>
                  <p class="card-text">
                    Manage blood inventory, donor appointments, and donation
                    requests.
                  </p>
                  <a href="login.html?role=hospital" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Hospital Login
                  </a>
                </div>
              </div>
            </div>
            <div class="col-4">
              <div class="card text-center">
                <div class="card-body">
                  <div class="stat-icon">
                    <i class="fas fa-heart"></i>
                  </div>
                  <h4 class="card-title">Donor Portal</h4>
                  <p class="card-text">
                    Schedule donations, track history, and earn rewards for
                    saving lives.
                  </p>
                  <a href="login.html?role=donor" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Donor Login
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Live Blood Availability -->
      <section
        id="availability"
        style="padding: 4rem 0; background-color: var(--secondary-gray-light)"
      >
        <div class="container">
          <h2 class="text-center mb-4">Live Blood Availability</h2>
          <div id="bloodAvailability" class="blood-type-grid">
            <div class="blood-type-card">
              <div class="blood-type">A+</div>
              <div class="blood-units">
                <span class="units-count" data-blood-type="A+">Loading...</span>
                units
              </div>
            </div>
            <div class="blood-type-card">
              <div class="blood-type">A-</div>
              <div class="blood-units">
                <span class="units-count" data-blood-type="A-">Loading...</span>
                units
              </div>
            </div>
            <div class="blood-type-card">
              <div class="blood-type">B+</div>
              <div class="blood-units">
                <span class="units-count" data-blood-type="B+">Loading...</span>
                units
              </div>
            </div>
            <div class="blood-type-card">
              <div class="blood-type">B-</div>
              <div class="blood-units">
                <span class="units-count" data-blood-type="B-">Loading...</span>
                units
              </div>
            </div>
            <div class="blood-type-card">
              <div class="blood-type">AB+</div>
              <div class="blood-units">
                <span class="units-count" data-blood-type="AB+"
                  >Loading...</span
                >
                units
              </div>
            </div>
            <div class="blood-type-card">
              <div class="blood-type">AB-</div>
              <div class="blood-units">
                <span class="units-count" data-blood-type="AB-"
                  >Loading...</span
                >
                units
              </div>
            </div>
            <div class="blood-type-card">
              <div class="blood-type">O+</div>
              <div class="blood-units">
                <span class="units-count" data-blood-type="O+">Loading...</span>
                units
              </div>
            </div>
            <div class="blood-type-card">
              <div class="blood-type">O-</div>
              <div class="blood-units">
                <span class="units-count" data-blood-type="O-">Loading...</span>
                units
              </div>
            </div>
          </div>
          <div class="text-center mt-4">
            <button
              class="btn btn-primary"
              onclick="refreshBloodAvailability()"
            >
              <i class="fas fa-sync-alt"></i> Refresh Data
            </button>
          </div>
        </div>
      </section>

      <!-- Emergency Blood Request -->
      <section id="emergency" class="container" style="padding: 4rem 0">
        <div class="row">
          <div class="col-8">
            <div class="card">
              <div class="card-header">
                <h3>
                  <i class="fas fa-exclamation-triangle text-danger"></i>
                  Emergency Blood Request
                </h3>
              </div>
              <div class="card-body">
                <form id="emergencyRequestForm">
                  <div class="row">
                    <div class="col-6">
                      <div class="form-group">
                        <label for="patientName" class="form-label"
                          >Patient Name *</label
                        >
                        <input
                          type="text"
                          id="patientName"
                          name="patientName"
                          class="form-control"
                          required
                        />
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="form-group">
                        <label for="bloodTypeNeeded" class="form-label"
                          >Blood Type Needed *</label
                        >
                        <select
                          id="bloodTypeNeeded"
                          name="bloodTypeNeeded"
                          class="form-control form-select"
                          required
                        >
                          <option value="">Select Blood Type</option>
                          <option value="A+">A+</option>
                          <option value="A-">A-</option>
                          <option value="B+">B+</option>
                          <option value="B-">B-</option>
                          <option value="AB+">AB+</option>
                          <option value="AB-">AB-</option>
                          <option value="O+">O+</option>
                          <option value="O-">O-</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-6">
                      <div class="form-group">
                        <label for="unitsNeeded" class="form-label"
                          >Units Needed *</label
                        >
                        <input
                          type="number"
                          id="unitsNeeded"
                          name="unitsNeeded"
                          class="form-control"
                          min="1"
                          max="10"
                          required
                        />
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="form-group">
                        <label for="urgencyLevel" class="form-label"
                          >Urgency Level *</label
                        >
                        <select
                          id="urgencyLevel"
                          name="urgencyLevel"
                          class="form-control form-select"
                          required
                        >
                          <option value="">Select Urgency</option>
                          <option value="critical">Critical (0-2 hours)</option>
                          <option value="high">High (2-6 hours)</option>
                          <option value="medium">Medium (6-12 hours)</option>
                          <option value="low">Low (12+ hours)</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="hospitalSelect" class="form-label"
                      >Hospital *</label
                    >
                    <select
                      id="hospitalSelect"
                      name="hospitalSelect"
                      class="form-control form-select"
                      required
                    >
                      <option value="">Select Hospital</option>
                      <!-- Options will be loaded dynamically -->
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="contactPerson" class="form-label"
                      >Contact Person *</label
                    >
                    <input
                      type="text"
                      id="contactPerson"
                      name="contactPerson"
                      class="form-control"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="contactPhone" class="form-label"
                      >Contact Phone *</label
                    >
                    <input
                      type="tel"
                      id="contactPhone"
                      name="contactPhone"
                      class="form-control"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="medicalReason" class="form-label"
                      >Medical Reason</label
                    >
                    <textarea
                      id="medicalReason"
                      name="medicalReason"
                      class="form-control"
                      rows="3"
                      placeholder="Brief description of why blood is needed"
                    ></textarea>
                  </div>
                  <div class="text-center">
                    <button type="submit" class="btn btn-danger btn-lg">
                      <i class="fas fa-paper-plane"></i> Submit Emergency
                      Request
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <div class="col-4">
            <div class="card">
              <div class="card-header">
                <h4>Emergency Guidelines</h4>
              </div>
              <div class="card-body">
                <ul style="padding-left: 1.2rem">
                  <li>
                    <strong>Critical:</strong> Life-threatening emergency
                    requiring immediate blood transfusion
                  </li>
                  <li>
                    <strong>High:</strong> Urgent surgery or severe blood loss
                  </li>
                  <li>
                    <strong>Medium:</strong> Planned surgery or medical
                    procedure
                  </li>
                  <li><strong>Low:</strong> Non-urgent medical requirement</li>
                </ul>
                <div class="alert alert-warning mt-3">
                  <i class="fas fa-info-circle"></i>
                  <strong>Note:</strong> This form is for registered hospitals
                  only. For immediate emergencies, please contact your nearest
                  hospital directly.
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- About Section -->
      <section
        id="about"
        style="padding: 4rem 0; background-color: var(--accent-white)"
      >
        <div class="container">
          <div class="row">
            <div class="col-6">
              <h2>About RaktSewa</h2>
              <p>
                RaktSewa is a comprehensive blood bank management system
                designed to streamline the process of blood donation, inventory
                management, and emergency blood requests. Our platform connects
                donors, hospitals, and patients in a seamless ecosystem that
                saves lives.
              </p>

              <div
                class="stats-grid"
                style="grid-template-columns: repeat(2, 1fr); margin: 2rem 0"
              >
                <div class="stat-card">
                  <div class="stat-number" id="totalDonors">1,247</div>
                  <div class="stat-label">Active Donors</div>
                </div>
                <div class="stat-card">
                  <div class="stat-number" id="totalHospitals">45</div>
                  <div class="stat-label">Partner Hospitals</div>
                </div>
                <div class="stat-card">
                  <div class="stat-number" id="totalDonations">8,932</div>
                  <div class="stat-label">Lives Saved</div>
                </div>
                <div class="stat-card">
                  <div class="stat-number" id="bloodUnits">2,156</div>
                  <div class="stat-label">Units Available</div>
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="card">
                <div class="card-header">
                  <h4>Our Mission</h4>
                </div>
                <div class="card-body">
                  <p>
                    To create a world where no life is lost due to blood
                    shortage by building an efficient, transparent, and
                    accessible blood donation network.
                  </p>

                  <h5 class="mt-3">Key Features:</h5>
                  <ul>
                    <li>
                      <i class="fas fa-check text-success"></i> Real-time blood
                      inventory tracking
                    </li>
                    <li>
                      <i class="fas fa-check text-success"></i> Emergency blood
                      request system
                    </li>
                    <li>
                      <i class="fas fa-check text-success"></i> Donor rewards
                      and recognition program
                    </li>
                    <li>
                      <i class="fas fa-check text-success"></i> Mobile-friendly
                      responsive design
                    </li>
                    <li>
                      <i class="fas fa-check text-success"></i> Comprehensive
                      reporting and analytics
                    </li>
                    <li>
                      <i class="fas fa-check text-success"></i> Notification
                      system for donors and hospitals
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Services Section -->
      <section
        id="services"
        style="padding: 4rem 0; background-color: var(--secondary-gray-light)"
      >
        <div class="container">
          <h2 class="text-center mb-4">Our Services</h2>
          <div class="row">
            <div class="col-4">
              <div class="card">
                <div class="card-body text-center">
                  <div class="stat-icon">
                    <i class="fas fa-calendar-check"></i>
                  </div>
                  <h4 class="card-title">Donation Scheduling</h4>
                  <p class="card-text">
                    Easy online booking for blood donation appointments at your
                    preferred hospital and time.
                  </p>
                </div>
              </div>
            </div>
            <div class="col-4">
              <div class="card">
                <div class="card-body text-center">
                  <div class="stat-icon">
                    <i class="fas fa-search"></i>
                  </div>
                  <h4 class="card-title">Blood Search</h4>
                  <p class="card-text">
                    Find available blood types across all partner hospitals in
                    real-time.
                  </p>
                </div>
              </div>
            </div>
            <div class="col-4">
              <div class="card">
                <div class="card-body text-center">
                  <div class="stat-icon">
                    <i class="fas fa-gift"></i>
                  </div>
                  <h4 class="card-title">Rewards Program</h4>
                  <p class="card-text">
                    Earn points for each donation and redeem them for health
                    checkups and gifts.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Active Campaigns -->
      <section
        id="campaigns"
        style="padding: 4rem 0; background-color: var(--accent-white)"
      >
        <div class="container">
          <h2 class="text-center mb-4">Active Donation Campaigns</h2>
          <div id="activeCampaigns" class="row">
            <!-- Campaigns will be loaded dynamically -->
          </div>
          <div class="text-center mt-4">
            <a href="#" class="btn btn-primary">View All Campaigns</a>
          </div>
        </div>
      </section>

      <!-- Contact Section -->
      <section
        id="contact"
        style="padding: 4rem 0; background-color: var(--secondary-gray-light)"
      >
        <div class="container">
          <h2 class="text-center mb-4">Contact Us</h2>
          <div class="row">
            <div class="col-6">
              <div class="card">
                <div class="card-header">
                  <h4>Get In Touch</h4>
                </div>
                <div class="card-body">
                  <div class="contact-info">
                    <div class="contact-item mb-3">
                      <i class="fas fa-phone text-primary"></i>
                      <span
                        ><strong>Emergency Hotline:</strong>
                        +91-999-BLOOD-01</span
                      >
                    </div>
                    <div class="contact-item mb-3">
                      <i class="fas fa-envelope text-primary"></i>
                      <span><strong>Email:</strong> support@raktsewa.com</span>
                    </div>
                    <div class="contact-item mb-3">
                      <i class="fas fa-map-marker-alt text-primary"></i>
                      <span
                        ><strong>Address:</strong> Medical District, Mumbai,
                        Maharashtra</span
                      >
                    </div>
                    <div class="contact-item mb-3">
                      <i class="fas fa-clock text-primary"></i>
                      <span
                        ><strong>Support Hours:</strong> 24/7 Emergency
                        Support</span
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="card">
                <div class="card-header">
                  <h4>Send Message</h4>
                </div>
                <div class="card-body">
                  <form id="contactForm">
                    <div class="form-group">
                      <label for="contactName" class="form-label">Name *</label>
                      <input
                        type="text"
                        id="contactName"
                        name="contactName"
                        class="form-control"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="contactEmail" class="form-label"
                        >Email *</label
                      >
                      <input
                        type="email"
                        id="contactEmail"
                        name="contactEmail"
                        class="form-control"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="contactSubject" class="form-label"
                        >Subject *</label
                      >
                      <input
                        type="text"
                        id="contactSubject"
                        name="contactSubject"
                        class="form-control"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="contactMessage" class="form-label"
                        >Message *</label
                      >
                      <textarea
                        id="contactMessage"
                        name="contactMessage"
                        class="form-control"
                        rows="4"
                        required
                      ></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">
                      <i class="fas fa-paper-plane"></i> Send Message
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer
      style="
        background-color: var(--secondary-gray-dark);
        color: var(--accent-white);
        padding: 2rem 0;
      "
    >
      <div class="container">
        <div class="row">
          <div class="col-4">
            <h5>RaktSewa</h5>
            <p>
              Connecting hearts, saving lives through the power of blood
              donation. Every drop counts, every life matters.
            </p>
            <div class="social-links">
              <a href="#" style="color: var(--accent-white); margin-right: 1rem"
                ><i class="fab fa-facebook"></i
              ></a>
              <a href="#" style="color: var(--accent-white); margin-right: 1rem"
                ><i class="fab fa-twitter"></i
              ></a>
              <a href="#" style="color: var(--accent-white); margin-right: 1rem"
                ><i class="fab fa-instagram"></i
              ></a>
              <a href="#" style="color: var(--accent-white)"
                ><i class="fab fa-linkedin"></i
              ></a>
            </div>
          </div>
          <div class="col-4">
            <h5>Quick Links</h5>
            <ul style="list-style: none; padding: 0">
              <li>
                <a href="#home" style="color: rgba(255, 255, 255, 0.8)">Home</a>
              </li>
              <li>
                <a href="#about" style="color: rgba(255, 255, 255, 0.8)"
                  >About Us</a
                >
              </li>
              <li>
                <a href="#services" style="color: rgba(255, 255, 255, 0.8)"
                  >Services</a
                >
              </li>
              <li>
                <a href="#contact" style="color: rgba(255, 255, 255, 0.8)"
                  >Contact</a
                >
              </li>
              <li>
                <a href="login.html" style="color: rgba(255, 255, 255, 0.8)"
                  >Login</a
                >
              </li>
              <li>
                <a href="register.html" style="color: rgba(255, 255, 255, 0.8)"
                  >Register</a
                >
              </li>
            </ul>
          </div>
          <div class="col-4">
            <h5>Emergency Contacts</h5>
            <p><i class="fas fa-phone"></i> Emergency: +91-999-BLOOD-01</p>
            <p><i class="fas fa-envelope"></i> emergency@raktsewa.com</p>
            <p><i class="fas fa-clock"></i> 24/7 Available</p>
          </div>
        </div>
        <hr
          style="border-color: rgba(255, 255, 255, 0.2); margin: 2rem 0 1rem"
        />
        <div class="text-center">
          <p>
            &copy; 2025 RaktSewa Blood Bank Management System. All rights
            reserved.
          </p>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="js/main.js"></script>

    <script>
      // Initialize the page
      document.addEventListener("DOMContentLoaded", function () {
        loadBloodAvailability();
        loadActiveCampaigns();
        loadHospitals();
        updateStatistics();

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", function (e) {
            e.preventDefault();
            const href = this.getAttribute("href");
            // Check if href is valid (not just '#')
            if (href && href.length > 1) {
              const target = document.querySelector(href);
              if (target) {
                target.scrollIntoView({
                  behavior: "smooth",
                  block: "start",
                });
              }
            }
          });
        });
      });

      // Load blood availability data
      function loadBloodAvailability() {
        fetch("php/get_blood_availability.php")
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              data.data.forEach((item) => {
                const element = document.querySelector(
                  `[data-blood-type="${item.blood_type}"]`
                );
                if (element) {
                  element.textContent = item.total_units || 0;
                }
              });
            }
          })
          .catch((error) => {
            console.error("Error loading blood availability:", error);
            document.querySelectorAll(".units-count").forEach((el) => {
              el.textContent = "N/A";
            });
          });
      }

      function refreshBloodAvailability() {
        document.querySelectorAll(".units-count").forEach((el) => {
          el.textContent = "Loading...";
        });
        loadBloodAvailability();
      }

      // Load active campaigns
      function loadActiveCampaigns() {
        fetch("php/get_campaigns.php?active=1&limit=3")
          .then((response) => response.json())
          .then((data) => {
            const container = document.getElementById("activeCampaigns");
            if (data.success && data.data.length > 0) {
              container.innerHTML = data.data
                .map(
                  (campaign) => `
                            <div class="col-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">${
                                          campaign.title
                                        }</h5>
                                        <p class="card-text">${campaign.description.substring(
                                          0,
                                          100
                                        )}...</p>
                                        <p class="text-muted">
                                            <i class="fas fa-calendar"></i> ${
                                              campaign.start_date
                                            } to ${campaign.end_date}
                                        </p>
                                        <div class="progress mb-2">
                                            <div class="progress-bar" style="width: ${
                                              ((campaign.collected_units || 0) /
                                                (campaign.target_units || 1)) *
                                              100
                                            }%"></div>
                                        </div>
                                        <small class="text-muted">${
                                          campaign.collected_units || 0
                                        }/${
                    campaign.target_units || 0
                  } units collected</small>
                                    </div>
                                </div>
                            </div>
                        `
                )
                .join("");
            } else {
              container.innerHTML =
                '<div class="col-12 text-center"><p>No active campaigns at the moment.</p></div>';
            }
          })
          .catch((error) => {
            console.error("Error loading campaigns:", error);
          });
      }

      // Load hospitals for emergency form
      function loadHospitals() {
        fetch("php/get_hospitals.php")
          .then((response) => response.json())
          .then((data) => {
            const select = document.getElementById("hospitalSelect");
            if (data.success) {
              // Handle both old and new API response structures
              const hospitals = data.data.hospitals || data.data || [];
              select.innerHTML =
                '<option value="">Select Hospital</option>' +
                hospitals
                  .map(
                    (hospital) =>
                      `<option value="${hospital.id}">${hospital.hospital_name} - ${hospital.city}</option>`
                  )
                  .join("");
            }
          })
          .catch((error) => {
            console.error("Error loading hospitals:", error);
          });
      }

      // Update statistics
      function updateStatistics() {
        fetch("php/get_statistics.php")
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              const stats = data.data;
              document.getElementById("totalDonors").textContent =
                stats.total_donors || "1,247";
              document.getElementById("totalHospitals").textContent =
                stats.total_hospitals || "45";
              document.getElementById("totalDonations").textContent =
                stats.total_donations || "8,932";
              document.getElementById("bloodUnits").textContent =
                stats.total_blood_units || "2,156";
            }
          })
          .catch((error) => {
            console.error("Error loading statistics:", error);
          });
      }

      // Handle emergency request form
      document
        .getElementById("emergencyRequestForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const formData = new FormData(this);

          fetch("php/emergency_request.php", {
            method: "POST",
            body: formData,
          })
            .then((response) => response.json())
            .then((data) => {
              if (data.success) {
                Swal.fire({
                  icon: "success",
                  title: "Request Submitted",
                  text: "Your emergency blood request has been submitted successfully. Hospitals will be notified immediately.",
                  confirmButtonColor: "#dc3545",
                });
                this.reset();
              } else {
                Swal.fire({
                  icon: "error",
                  title: "Submission Failed",
                  text: data.message,
                  confirmButtonColor: "#dc3545",
                });
              }
            })
            .catch((error) => {
              console.error("Error:", error);
              Swal.fire({
                icon: "error",
                title: "Error",
                text: "An error occurred while submitting your request.",
                confirmButtonColor: "#dc3545",
              });
            });
        });

      // Handle contact form
      document
        .getElementById("contactForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          Swal.fire({
            icon: "success",
            title: "Message Sent",
            text: "Thank you for your message. We will get back to you soon.",
            confirmButtonColor: "#dc3545",
          });
          this.reset();
        });
    </script>
  </body>
</html>
